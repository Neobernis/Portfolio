# Предсказание потенциального расторжения договора клиентом
Jupyter Notebook: [ipynb](https://nbviewer.org/github/Neobernis/Portfolio/blob/main/Telecom/Telecom_classification.ipynb)

Стек: Pandas, CatBoost, Shap, Scikit-learn: RandomizedSearchCV, Pipeline

**Задача проекта** :  обучить для прогноза оттока клиентов.\
**Критерий успеха** : метрика ROC-AUC выше или равна 0.85.

Описание проекта:
Оператор связи хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах. 

## Вывод:
  
Данные предобработаны от пропусков. Наличие даты окончания договора является утечкой целевого признака, поэтому признак был удален.

Исследовательский анализ данных выявил, что расторгнувших договоров от общей выборки составляет 15.6% пользователей. В среднем выручка за срок жизни клиента равняется 2115. Обнаружена слабая корреляция DaysContract с таргетом на 0.37 и TotalCharges на 0.30. Среди клиентов с чеком MonthlyCharges выше 100 – 28% расторгли договор, что на 13% выше значения по всей выборке.

В процессе поиска лучшей модели протестированы: KNeighborsClassifier, LogisticRegression, DecisionTreeClassifier и CatBoostClassifier с различным перебором гиперпараметров. Лучшей показала себя модель CatBoostClassifier со следующими гиперпараметрами:

| <!-- --> | <!-- --> |
| :-------------------- | :--------------------- |
|iterations |500|
|verbose |False|
|max_depth	|2|
|learning_rate |0.3|
|l2_leaf_reg	|1|

Метрика ROC-AUC на кросс-валидации составляет 0.9181.

Топ 5 по важности признаков:

- DaysContract;
- TotalCharges;
- Type;
- Partner;
- MonthlyCharges.
  
Высокое значение MonthlyCharges и Type со значением срока заключения договора на 1 или 2 года, тянут предсказание класса к расторжению договора. А чем выше DaysContract и ниже TotalCharges, тем выше вероятность продолжать пользоваться услугами и далее. Для тарифов со значением MonthlyCharges от 20 до 40, техническая поддержка благоприятно влияет на вероятность продления договора.

На тесте метрика ROC-AUC составляет 0.9331. Данные значения превосходят заданный критерий успеха не менее 0.85.

В дальнейшем рекомендуется корректировать веса классов для минимизации False positive или False negative ошибок. Если отправка промокода уже лояльному клиенту, относительно не затратное для бизнеса действие с точки зрения недополученной прибыли, тогда веса классов модели изменить в пользу метрики recall для более эффективного нахождения оттока. В обратном случае, сфокусироваться на качестве метрики precision.

![image](https://github.com/Neobernis/Portfolio/assets/109903977/dc3d21ef-9989-4bb8-8782-82a04512b93a)

